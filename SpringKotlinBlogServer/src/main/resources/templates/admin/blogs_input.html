<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">


<head th:replace="_fragments.html::head(title='Blog input Page')">
<body>

<!-- Nav-->

<div th:replace="_fragments.html::admin_nav(0)"></div>

<div class="container text-right">
    <div class="btn-group" role="group" aria-label="Basic example">
        <button type="button" class="btn btn-secondary ">Post</button>
        <button type="button" class="btn btn-secondary active">List</button>
    </div>


</div>

<!-- contect-->
<div class="container pt-3">
    <form method="post" th:action="@{/admin/blogs}">
        <input type="hidden" name="flag" id="flag"/>
        <input type="hidden" name="published" id="published"/>
        <div class="input-group mb-3">
            <div class="input-group-prepend">
                <button class="btn btn-outline-secondary dropdown-toggle" id="drop_down_button_before_title"
                        type="button"
                        data-toggle="dropdown"
                        aria-haspopup="true" aria-expanded="false">Dropdown
                </button>
                <div class="dropdown-menu">
                    <a class="dropdown-item dropdown-item_before_title" href="#">Original</a>

                </div>
            </div>
            <input type="text" class="form-control" placeholder="Title" name="title">
            <div class="invalid-feedback" id="titleError">
                Please input title
            </div>
        </div>

        <div class="form-group">
            <div id="test-editor">
                <textarea rows="3" style="display:none;" name="content">dfgfdgfdg</textarea>
            </div>

        </div>

        <div class="form-row">
            <div class="input-group col">
                <div class="input-group-prepend">
                    <div class="input-group-text">Type</div>
                </div>
                <select class="form-control" name="typeId">

                    <th:block th:each="type:${types}">
                        <option th:value="${type.getId()}" th:text="${type.getName()}">Default Category 1
                        </option>
                    </th:block>


                </select>
            </div>
            <!--            TODO Tags-->
            <!-- <div class="input-group col">
                 <div class="input-group-prepend">
                     <div class="input-group-text">Tag</div>
                 </div>
                 <select class="custom-select ">
                     <option selected>1</option>
                     <option value="2">One</option>
                     <option value="3">Two</option>
                     <option value="4">Three</option>
                 </select>
             </div>-->
        </div>

        <div class="input-group mt-3">
            <div class="input-group-prepend">
                <div class="input-group-text">Image</div>
            </div>
            <input type="text" class="form-control" placeholder="image address" name="firstPicture">
        </div>

        <div class="mt-3">

            <div class="custom-control custom-checkbox m_inline_block">
                <input class="form-check-input " type="checkbox" name="recommend">
                <label class="form-check-label">
                    recommend
                </label>

            </div>
            <div class="custom-control custom-checkbox m_inline_block">


                <input class="form-check-input " type="checkbox" name="shareStatement">
                <label class="form-check-label">
                    from other people
                </label>
            </div>
            <div class="custom-control custom-checkbox m_inline_block">

                <input class="form-check-input " type="checkbox" name="appreciation">
                <label class="form-check-label">
                    like
                </label>
            </div>
            <div class="custom-control custom-checkbox m_inline_block">


                <input class="form-check-input " type="checkbox" name="commentabled">
                <label class="form-check-label">
                    commentable
                </label>
            </div>
        </div>

        <div class="mt-2">
            <div class="btn btn-primary">Back</div>
            <button type="submit" class="btn btn-primary" id="bt_save">Save</button>

            <button type="submit" class="btn btn-primary" id="bt_post">Post</button>

        </div>
    </form>

</div>


<!-- footer-->

<!---->
<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<div th:replace="_fragments.html::script"></div>
<!--<script src="../../static/lib/editormd/editormd.js"></script>-->
<script th:src="@{/lib/prism/prism.js}"></script>
<script th:src="@{/lib/editormd/editormd.js}"></script>
<script>
    $(document).ready(function () {

        let dropdown_item_before_title = $(".dropdown-item_before_title")
        let dropdown_item_before_title_values = []
        dropdown_item_before_title.each(function () {

            dropdown_item_before_title_values.push($(this).text())
        })
        console.log(dropdown_item_before_title_values)
        if (dropdown_item_before_title_values.length > 0) {
            let t = dropdown_item_before_title_values[0]
            $("#drop_down_button_before_title").text(t)
            $("#flag").val(t)
        }

        dropdown_item_before_title.click(function () {
            //TODO here to change the select text
            let text = $(this).text()
            $("#drop_down_button_before_title").text(text)
            $("#flag").val(text)
        });


        $('form').submit(function () {
            let clickedBtId = $(document.activeElement).attr('id')

            let published = $("#published")
            if (clickedBtId === 'bt_save') {
                //    save
                published.val("false")

            } else {
                //    post
                published.val("true")
            }


            //TODO need to check the form title content require
            let titleInput = $('[name ="title"]')
            let titleError = $('#titleError')
            let content = $('[name ="content"]')
            let titleInputIsEmpty = $.trim(titleInput.val()) === ''
            let contentIsEmpty = $.trim(content.text()) === ''
            console.log(titleInput.val())
            console.log(content.text())
            console.log(titleInputIsEmpty)
            console.log(contentIsEmpty)
            if (titleInputIsEmpty || contentIsEmpty) {
                if (titleInputIsEmpty) {
                    titleInput.addClass('is-invalid')
                    titleError.text("title should not empty")
                }
                if (contentIsEmpty) {
                    content.text("please input something")
                }


                return false
            } else {

                return true
            }


        })


    });

    let testEditor;

    $(function () {
        testEditor = editormd("test-editor", {
            width: "100%",
            height: 640,
            syncScrolling: "single",
            path: "../static/lib/editormd/lib/"
        });

        /*
        // or
        testEditor = editormd({
            id      : "test-editormd",
            width   : "90%",
            height  : 640,
            path    : "../lib/"
        });
        */
    });


</script>
</body>
</html>
